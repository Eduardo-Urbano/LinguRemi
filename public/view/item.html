<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinguRemi</title>
    <link rel="stylesheet" href="../assets/css/output.css">
    <link rel="shortcut icon" href="../assets/images/icones/logo1.ico" type="image/x-icon">
</head>
<body class="flex flex-col min-h-screen scroll-mt-4">
    <header class="flex justify-between items-center px-5 shadow-sm">
        <nav class="flex flex-row gap-x-6 text-xl w-1/3">
            <ul class="flex flex-row space-x-6">
                <li><a href="./produtos.html">Produtos</a></li>
                <li><a href="#footer">Sobre nós</a></li>
                <li><a href="./blog.html">Blog</a></li>
            </ul>
        </nav>

        <div class="flex justify-center w-1/3">
            <img class="w-62" src="../assets/images/logo/logo1.png" id="">
        </div>

        <nav class="flex flex-row gap-x-6 text-xl w-1/3 justify-end">
            <ul class="flex flex-row space-x-6">
                <li><a id="ident0" class="flex" href="#">Login</a></li>
                <li><a id="ident1" class="hidden" href="./perfil.html"></a></li>
                <li><a href="./index.html"><img src="../assets/images/icones/Home.png" alt="Página inicial"></a></li>
                <li><a href="./carrinho.html"><img src="../assets/images/icones/carrinho2.png" alt="Meu Carrinho"></a></li>
            </ul>
        </nav>
    </header>
    
    <!--Conteudo da pagina-->
    <main class="container mx-auto p-4 px-4 pb-12">
        <div id="produto" class="flex justify-center"></div>
    </main>

    <footer id="footer" class="text-gray-200 pt-32 bg-linear-to-br from-gray-500 from-1% via-gray-700 via-9% to-black to-90%">
        <div class="container mb-0 mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between gap-6">
            
                <div class="md:w-2/5 min-w-0">
                    <a href="#">
                        <img class="mt-0 max-h-1/4 max-w-10/12 place-self-center" src="../assets/images/icones/logo1.ico" alt="LinguRemi">
                    </a>
                    <p class="mt-6 text-gray-300 wrap-break-words max-w-full overflow-hidden whitespace-normal">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit.
                        Lorem ipsum dolor, sit amet consectetur adipisicing elit. Eaque eos consectetur consequuntur sunt sequi sint inventore nesciunt, omnis iure repellendus possimus cumque. Distinctio vel cum iusto quia corrupti. Recusandae, quibusdam!
                    </p>
                </div>

                <div class="col-span-1 md:col-span-3 lg:col-span-2">
                    <h5 class="tracking-wide text-gray-100 font-semibold">Company</h5>
                    <ul class="list-none mt-6 space-y-2">
                        <li><a href="#" class="text-gray-300 hover:text-gray-400 transition-all duration-500">Nosso Blog</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-gray-400 transition-all duration-500">Trabalhe conosco</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-gray-400 transition-all duration-500">Contato</a></li>
                    </ul>
                </div>

                <div class="col-span-1 md:col-span-3 lg:col-span-2">
                    <h5 class="tracking-wide text-gray-100 font-semibold">Redes sociais</h5>
                    <ul class="list-none mt-6 space-y-2">
                        <li><a href="#" class="text-gray-300 hover:text-gray-400 transition-all duration-500">WhatsApp</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-gray-400 transition-all duration-500">Instagram</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-gray-400 transition-all duration-500">TikTok</a></li>
                    </ul>
                </div>

            </div>
        </div>
        <div class="text-center mt-1 pb-10">©LinguRémi 2025</div>
    </footer> 
    <script>
       document.addEventListener("DOMContentLoaded", async () => {
    const cont1 = document.getElementById("produto");
    if (!cont1) return;

    // Função para buscar produto pelo ID
    async function carregarProdutoPorId(id) {
        const response = await fetch(`http://localhost:8080/receitas/produtos/${id}`);
        return response.ok ? response.json() : null;
    }

    // Pegar id da URL ex: item.html?id=3
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    if (!id) {
        cont1.innerHTML = "<p class='text-center text-lg'>Produto não encontrado.</p>";
        return;
    }

    const produto = await carregarProdutoPorId(id);
    if (!produto) {
        cont1.innerHTML = "<p class='text-center text-lg'>Erro ao carregar produto.</p>";
        return;
    }

    // Quantidade de acordo com tipoQuantidade
    let campoQuantidade = "";
    if (produto.tipoquantidadeReceitas === "unidade") {
        campoQuantidade = `
            <label class="font-medium mb-1">Quantidade: </label>
            <input type="number" min="5" value="5" class="border rounded p-1 w-20 text-center" />
            <span class="ml-1 text-sm text-gray-600">un</span>
        `;
    } else if (produto.tipoquantidadeReceitas === "peso") {
        campoQuantidade = `
            <label class="font-medium mb-1">Peso: </label>
            <input type="number" step="0.100" min="0.100" value="1.00" class="border rounded p-1 w-20 text-center" />
            <span class="text-sm text-gray-600">kg</span>
        `;
    }

    let campoDisponivel = produto.disponivelReceitas > 0
        ? `<h3 class="font-medium text-base mb-5 pl-3">Em estoque (${produto.disponivelReceitas} disponíveis)</h3>`
        : `<h3 class="text-red-600 font-medium text-base mb-5 pl-3">Produto indisponível</h3>`;

    // Montar card
    const card = document.createElement("div");
    card.className = "mx-auto rounded-xl shadow-lg bg-gray-100 gap-6 w-max justify center";

    card.innerHTML = `
        <div class="flex flex-row p-5 gap-6">
            <div class="flex">
                <img src="http://localhost:8080/${produto.imgReceitas}" alt="${produto.nomeReceitas}" class="w-180 h-120 rounded-xl object-cover">
            </div>
            <div class="rounded-xl bg-white shadow-lg p-5 w-90 items-center">
                <h1 class="font-semibold text-2xl pl-3">${produto.nomeReceitas}</h1>
                <span class="text-sm pl-3">★${produto.avaliacaoReceitas} avaliações</span>
                <h2 class="font-medium text-xl mt-5 mb-5 pl-3">R$ ${produto.valorReceitas.toFixed(2)}</h2>
                <div class="mb-5 pl-3">${campoQuantidade}</div>
                <div class="mb-5 pl-3">${campoDisponivel}</div>
                <div class="text-center items-center">
                    <button class="rounded-xl shadow-lg hover:bg-gray-200 w-70 p-0.5 pl-1 pr-1 mb-5 transition btn-add-cart">Adicionar ao Carrinho</button>
                    <button class="rounded-xl shadow-lg hover:bg-gray-200 w-70 p-0.5 pl-1 pr-1 mb-2 transition btn-add-cart-now">Comprar Agora</button>
                </div>
            </div>
            <div class="mt-6 border-t pt-4">
                <h2 class="text-xl font-semibold pl-5 mb-2">Descrição</h2>
                <p class="text-lg leading-relaxed pl-5">${produto.descReceitas || "Sem descrição disponível."}</p>
            </div>
        </div>
    `;
    cont1.appendChild(card);
    
    const btn2 = card.querySelector(".btn-add-cart-now");
    if (btn2) {
        btn2.addEventListener("click", () => {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            const qtd = Number(card.querySelector("input").value);
            console.log(produto);
            cart.push({
                id: produto.idReceitas,
                nome: produto.nomeReceitas,
                preco: produto.valorReceitas,
                imagem: `http://localhost:8080/${produto.imgReceitas}`,
                quantidade: qtd,
                tipoQuantidade: produto.tipoquantidadeReceitas
            });

            localStorage.setItem("cart", JSON.stringify(cart));
            window.location.href = "carrinho.html";
        });
    }

    // Botão adicionar ao carrinho
    const btn = card.querySelector(".btn-add-cart");
    btn.addEventListener("click", () => {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const qtd = Number(card.querySelector("input").value);

        cart.push({
            id: produto.idReceitas,
            nome: produto.nomeReceitas,
            preco: produto.valorReceitas,
            imagem: `http://localhost:8080/${produto.imgReceitas}`,
            quantidade: qtd,
            tipoQuantidade2: produto.tipoquantidadeReceitas
        });

        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`${produto.nomeReceitas} foi adicionado ao carrinho!`);
    });
});
        </script>
        
    
    
        
</body>
</html>